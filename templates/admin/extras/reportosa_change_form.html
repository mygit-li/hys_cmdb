{% extends "admin/change_form.html" %}
{% load i18n admin_urls static admin_modify %}

{% block extrahead %}{{ block.super }}
<script type="text/javascript" src="{% url 'admin:jsi18n' %}"></script>
    <script>
        django.jQuery(function() {
            var select_web = django.jQuery("#id_machine_room_id");
            select_web.change(function(){
                var url = "/report/sub_web_machines/"+django.jQuery(this).val();//能够正确的访问到view的url
                django.jQuery.get(
                    url,
                    function(data){
                        var target = django.jQuery("#id_web_server");
                        target.empty();//先要清空一下
                        data.forEach(function(e){
                            // 将从view得到的id和db_user名称赋值给db_server的select
                            target.append("<option value='"+e.id+"'>"+e.name+"<option>");
                            target.eq(0).attr('selected', 'true');
                        });
                })
            });
            var select_db = django.jQuery("#id_machine_room_id");
            select_db.change(function(){
                var url = "/report/sub_db_machines/"+django.jQuery(this).val();//能够正确的访问到view的url
                django.jQuery.get(
                    url,
                    function(data){
                        var target = django.jQuery("#id_db_server");
                        target.empty();//先要清空一下
                        data.forEach(function(e){
                            // 将从view得到的id和db_user名称赋值给db_server的select
                            target.append("<option value='"+e.id+"'>"+e.name+"<option>");
                            target.eq(0).attr('selected', 'true');
                        });
                })
            });
            var select_d_user = django.jQuery("#id_project");
            select_d_user.change(function(){
                var url = "/report/sub_de_users/"+django.jQuery(this).val();//能够正确的访问到view的url
                django.jQuery.get(
                    url,
                    function(data){
                        var target = django.jQuery("#id_de_proposer");
                        target.empty();//先要清空一下
                        data.forEach(function(e){
                            // 将从view得到的id和db_user名称赋值给db_server的select
                            target.append("<option value='"+e.id+"'>"+e.name+"<option>");
                            target.eq(0).attr('selected', 'true');
                        });
                })
            });
            var select_f_user = django.jQuery("#id_project");
            select_f_user.change(function(){
                var url = "/report/sub_fde_users/"+django.jQuery(this).val();//能够正确的访问到view的url
                django.jQuery.get(
                    url,
                    function(data){
                        var target = django.jQuery("#id_fde_proposer");
                        target.empty();//先要清空一下
                        data.forEach(function(e){
                            // 将从view得到的id和db_user名称赋值给db_server的select
                            target.append("<option value='"+e.id+"'>"+e.name+"<option>");
                            target.eq(0).attr('selected', 'true');
                        });
                })
            });
            var select_p = django.jQuery("#id_project_type");
            select_p.change(function(){
                var url = "/report/sub_pro_types/"+django.jQuery(this).val();//能够正确的访问到view的url
                django.jQuery.get(
                    url,
                    function(data){
                        var target = django.jQuery("#id_project");
                        target.empty();//先要清空一下
                        data.forEach(function(e){
                            // 将从view得到的id和db_user名称赋值给db_server的select
                            target.append("<option value='"+e.id+"'>"+e.name+"<option>");
                            target.eq(0).attr('selected', 'true');
                        });
                })
            });
        });
    </script>
{#{{ media }}#}
{% endblock %}
